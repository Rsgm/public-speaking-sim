{% extends "base.html" %}
{% load static from staticfiles %}{% load i18n %}
{% block title %} - {{ group.name }}{% endblock %}


{% block breadcrumbs %}
  {% include "groups/breadcrumb.html" %}
  <li><span>g</span></li>
  <li class="uk-active"><span>{{ group.slug }}</span></li>
{% endblock %}


{% block content %}
  <div class="uk-block">
    {% if group.logo %}
      <img src="{{ group.logo.url }}">
    {% endif %}
    <h2 class="uk-text-center">{{ group.name }} Dashboard</h2>
  </div>


  <div class="uk-grid">
    {% if 'list_submission' in view.permissions %}
      <div class="uk-width-small-1-1 uk-width-medium-2-4 uk-push-1-4 uk-container">
        <h3><a href={% url 'groups:group:submission:list' group.slug %}>Submissions</a></h3>

        <div class="uk-flex uk-flex-column">
          {% for submission in submission_list %}
            <a href="{% url 'recordings:recording:view' 'grader' submission.pk %}" class="card-1 uk-grid">
              <div class="uk-width-1-4">{{ submission.recording.project.user }}</div>
              <div class="uk-width-1-4 uk-text-center">{{ submission.recording.project.name }}</div>
              <div class="uk-width-2-4 uk-text-center">{{ submission.created_time }}</div>
            </a>
          {% endfor %}
        </div>
      </div>
    {% endif %}


    {% if 'list_user' in view.permissions %}
      <div class="uk-width-small-1-1 uk-width-medium-1-4 uk-pull-2-4 uk-container">
        <h3><a href={% url 'groups:group:user:list' group.slug %}>Users</a></h3>

        <div class="uk-flex uk-flex-column">
          {% for membership in user_list %}
            <a {#href="{% url 'groups:group:user:view' group.slug membership.user.email %}"#} class="card-1 uk-grid">
              <div class="uk-width-1-3">{{ membership.user.username }}</div>
              <div class="uk-width-1-3">{% for role in membership.all.roles %}{{ role.name }}{% endfor %}</div>
              <div class="uk-width-1-3">{{ membership.roles__permissions__count }}</div>
            </a>
          {% endfor %}
        </div>
      </div>
    {% endif %}


    {% if 'add_invite' in view.permissions or 'list_invite' in view.permissions %}
      <div class="uk-width-small-1-1 uk-width-medium-1-4 uk-container">
        <h3><a href={% url 'groups:group:invite:list' group.slug %}>Invites</a></h3>

        {% if 'add_invite' in view.permissions %}
          <a href="{% url 'groups:group:invite:add' group.slug %}">Create Invite</a>
        {% endif %}

        {% if 'list_invite' in view.permissions %}
          <div class="uk-flex uk-grid">
            {% for invite in invite_list %}
              <div class="uk-width-small-1-3 uk-width-medium-1-4 uk-width-large-1-6">
                <a href="{% url 'groups:group:invite:view' group.slug invite.slug %}"
                   class="uk-panel uk-panel-box panel-card uk-panel-header">

                  <h3 class="uk-panel-title">{{ invite.name }}</h3>

                  <div class="item-info">
                    <div>Created: {{ invite.created_time }}</div>
                    {% if invite.uses %}
                      <div>Uses left: {{ invite.uses }}</div>{% endif %}
                    {% if invite.expires %}
                      <div>Expires: {{ invite.expires }}</div>{% endif %}
                    <div>Token: {{ invite.token }}</div>
                  </div>
                </a>
              </div>
            {% endfor %}
          </div>
        {% endif %}

      </div>
    {% endif %}

  </div>
{% endblock %}
